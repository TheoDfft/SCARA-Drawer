<launch>
    

    <arg name="visualize" default="true" />
    <arg name="marker_frame"    default="aruco_marker_link"/>
    <arg name="camera_frame"    default="camera_link"/>
    <arg name="desired_pose_topic"    default="/aruco_single/pose"/>
    <node pkg="tf" type="static_transform_publisher" name="camera_transform_publisher" args="0.0 0.15 0.20 0 -1 0 0 world $(arg camera_frame) 100" />
    <node pkg="tf" type="static_transform_publisher" name="pen_tip_transform_publisher" args="0.0 0.0 -0.077 0 0 0 1 $(arg marker_frame) pen_tip 100" />

    <include file="$(find aruco_ros)/launch/single.launch">
        <arg name="markerSize" value="0.030" />
        <arg name="markerId" value="10" />
        <arg name="marker_frame"    value="$(arg marker_frame)"/>
        <arg name="ref_frame"       value=""/>
        <arg name="camera_frame"    value="$(arg camera_frame)"/>
        <arg name="camera_info_topic" value="/camera/camera_info" />
        <arg name="image_topic" value="/camera/image" />
    </include>

    <!-- <node pkg="scara_drawer_ros" type="pose_fused_publisher.py" name="pose_fused_publisher" output="screen"/> -->

    <!-- Launch the Pen Tracking Controller -->
    <node pkg="scara_drawer_ros" type="pen_tracking_controller.py" name="pen_tracking_controller" output="screen">
        <param name="control_rate" value="10.0" /> 
        <param name="max_velocity" value="0.2" /> 
        <param name="goal_tolerance" value="0.0001" /> 
        <param name="desired_pose_topic" value="$(arg desired_pose_topic)" />
    </node>

  
    <!-- <node pkg="rosbag" type="play" name="pose_player" args="$(find scara_drawer_ros)/data/test_pose_player.bag /tool/kinematics_pose:=/tool/desired_pose"/> -->

    <!-- <group if="$(arg visualize)">
        <node pkg="rviz" type="rviz" name="rviz" args="-d $(find scara_drawer_ros)/rviz/pen_tracker.rviz" />
    </group> -->

</launch>